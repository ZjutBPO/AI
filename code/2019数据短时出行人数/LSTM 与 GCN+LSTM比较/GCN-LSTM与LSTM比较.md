流的短时预测功能。

因为2020年的出行数据中，各个站点每小时的出行人数很少，甚至有0的情况，无法进行客流的短时预测。因此我们选用2019年天池全球城市计算 AI 挑战赛的数据集进行训练和预测。

一开始选择用长短期记忆网络（LSTM）模型进行拟合。该网络在1997年由Hochreiter和Schmidhuber在Long short-term memory中提出。是现在深度学习的主流之一。

LSTM考虑了客流在时间上的相关性，即如果之前45分钟当前站点有较大的客流，则接下来的15分钟可能也会有较大的客流。使用LSTM对时间维度上的信息进行提取。得到的预测结果中，均方根误差是110，平均绝对误差为71，平均绝对百分比误差为12.7%，判定系数R2为0.977

接着考虑到当前站点的客流量与邻近站点的客流量有关，即如果邻近站点有大量客流，则当前站点接下可能也会有较大客流。

因为描述站点之间关系的是拓扑图，是非欧几里得数据，所以难以用卷积神经网络（CNN）进行空间信息的提取。于是选择图卷积网络（GCN）来进行客流空间上信息的提取。

图卷积网络由Thomas Kipf在2016年发布的论文《Semi-Supervised Classification with Graph Convolutional Networks》中提出。该篇论文也是这一方向的奠基之作。

在原来长短期记忆网络（LSTM）的基础上，使用图卷积（GCN）对包括邻近站点在内的客流的信息进行空间维度上信息的提取。再将提取出来的信息放入到LSTM中，进行时间维度上信息的提取。最后的得到的结果中，均方根误差从110降低到了55，平均绝对误差从71降低到了41，平均绝对百分比误差从12.7%降低到了7.9%，判定系数R2也从0.907提高到了0.977。

| 损失函数                 | GCN-LSTM | LSTM    |
| ----------------------- | -------- | ------- |
| RMSE（均方根误差）       | 54.893   | 109.797 |
| MAE（平均绝对误差）      | 41.071   | 71.877  |
| R2（判定系数）           | 0.977    | 0.907   |
| MAPE（平均绝对百分误差） | 0.079    | 0.127   |

**R2判决系数**

是对估计的回归方程拟合优度的度量，是表达因变量与所有自变量之间的总体关系。即反映因变量的全部变化能通过回归关系被自变量解释的比例。其值取值范围是[0,1]，越接近于1说明自变量越能解释因变量的方差变化，值越小则说明效果越差。

| 下一个时间段的客流量往往与之前几个时间段的客流量有关| 当前站点的客流量往往与邻近站点的客流量有关。描述站点之间关系的是一张拓扑图。是非欧几里得数据。||
|-|-|-|
|长短期记忆网络（LSTM）|图卷积（GCN）|图卷积+长短期记忆网络|
| 1997年由Hochreiter和Schmidhuber在Long short-term memory中提出。是现在深度学习的主流之一 | Thomas Kipf在2016年发布的论文《Semi-Supervised Classification with Graph Convolutional Networks》中提出。该篇论文也是这一方向的奠基之作|GCN进行空间信息的提取，LSTM进行时间信息的提取|
|考虑了客流在时间上的相关性|考虑了客流在空间上的相关性|考虑客流的时间性与空间性|
| 输入：站点前几个时间段的客流量、温度、湿度、疫情新增人数|输入：站点以及邻近站点的客流量、温度、湿度、疫情新增人数|输入：站点及邻近站点前几个时间段的参数|

|                                  | GCN+LSTM | LSTM    | GCN     |
| -------------------------------- | -------- | ------- | ------- |
| rmse均方根误差                   | 51.0734  | 97.179  | 73.3906 |
| mae平均绝对误差                  | 38.1784  | 67.6438 | 52.0184 |
| r2拟合优度                       | 0.985    | 0.9392  | 0.9682  |
| explained varience score可释方差 | 0.9856   | 0.9424  | 0.9684  |
| mape平均绝对百分误差             | 0.0836   | 0.1402  | 0.1044  |